<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pago - Plan B</title>
  <link rel="stylesheet" href="/assets/vendor/bootstrap/css/bootstrap.min.css">
</head>
<body class="container py-5">

  <h1 class="mb-4">Suscripción al Plan B</h1>
  <p>Duración: <strong>3 meses</strong></p>
  <p>Precio: <strong>S/. 138</strong></p>
  <p>Descripción: Sabés que quieres cambiar tu rutina y estás listo para sudar tres meses seguidos.</p>

  <button class="btn btn-success" onclick="confirmarPago()">Confirmar Suscripción</button>
  <p id="mensaje" class="mt-3 text-success fw-bold"></p>

  <script>
    function confirmarPago() {
      fetch("/api/boletas", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          idPlan: 2
        })
      })
      .then(res => {
        if (res.ok) return res.text();
        else throw new Error("Error en el registro");
      })
      .then(msg => {
        document.getElementById("mensaje").innerText = msg;
      })
      .catch(err => {
        document.getElementById("mensaje").innerText = "Error al registrar la suscripción.";
        console.error(err);
      });
    }
  </script>
  <script>
    const dniUsuario = localStorage.getItem("dniUsuario");
      console.log("DNI cargado desde localStorage:", dniUsuario); // <-- AÑADIDO
      if (!dniUsuario) {
        alert("No has iniciado sesión. Redirigiendo al login.");
        window.location.href = "/login";
      }
  </script>

</body>
</html>
